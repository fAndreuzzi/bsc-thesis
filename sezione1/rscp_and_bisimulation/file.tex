\subsection{Equivalenza tra \rscp e massima bisimulazione}
\label{sec:bisi_and_rscp}
In quest'ultima sezione della prima parte di questo elaborato esamineremo un legame fondamentale, che fungerà da base per quanto presenteremo nelle sezioni seguenti.

Dimostriamo innanzitutto il seguente risultato preliminare \cite{gentilini}:
\begin{proposition}
    Sia $G = (V,E)$. Sia $\mathfrak{V}$ una partizione di $V$ stabile rispetto a $E$. Allora la relazione binaria $\mathcal{R}$ su $V$ definita come:
    \begin{gather*}
        a \mathcal{R} b \iff [a]_\mathfrak{V} = [b]_\mathfrak{V}
    \end{gather*}
    è una bisimulazione su $G$.
    \label{prop:part_induce_bisi}
\end{proposition}
\begin{proof2}
    Siano $a,b \in G \mid a \mathcal{R} b$, e sia $a' \mid \langle a, a' \rangle \in E$. Poichè $\mathfrak{V}$ è stabile, si ha che $[a]_\mathfrak{V} \subseteq E^{-1}([a']_\mathfrak{V})$. Quindi $\exists b' \in [a']_\mathfrak{V} \mid \langle b, b' \rangle \in E$.

    L'altra condizione caratteristica della bisimulazione si dimostra in modo speculare.
\end{proof2}
In altre parole, una qualsiasi partizione stabile rispetto a $E$ induce su un grafo diretto una bisimulazione che può essere ricavata in modo banale.

Dimostriamo ora il risultato opposto:
\begin{proposition}
    Sia $\mathcal{R}$ una bisimulazione su $G$ che sia anche una relazione di equivalenza. Allora la partizione $\mathfrak{X}$ i cui blocchi sono le classi di equivalenza di $\mathcal{R}$ è stabile rispetto a $E$.
    \label{prop:bisi_induce_part}
\end{proposition}
\begin{proof2}
    Se per assurdo $\mathfrak{X}$ non fosse stabile esisterebbero due blocchi $x_1, x_2 \mid x_1 \,\,\cap E^{-1}(x_2)$ non è ne $x_1$ nè $\emptyset$. Poniamo $A \coloneqq x_1 \,\,\cap E^{-1}(x_2)$.

    Gli elementi $a$ di $A$ sono i nodi in $x_1 \mid \nexists b \in x_2$ per cui vale $\langle a, b \rangle \in E$. Ma poichè questi $a$ e gli $x \in x_1 - A$ si trovano all'interno dello stesso blocco $x_1$ deve valere $x \mathcal{R} a$.

    Sia $x \in x_1 - A$, ed $y \in x_2 \mid \langle x, y \rangle \in E$. Poichè $\forall a \in A$ vale $x \mathcal{R} a$, allora $\exists a' \mid \langle a, a' \rangle \in E, \langle a', y \rangle \in E$, cioè $[a']_\mathfrak{X} = [y]_\mathfrak{X} = x_2$. Quindi $A$ deve necessariamente essere vuoto.
\end{proof2}

Cioè una bisimulazione induce un partizionamento stabile rispetto a $E$ dei nodi del grafo. Vale il seguente corollario:
\begin{corollary}
    Determinare la massima bisimulazione su un grafo diretto $G = (V,E)$ e trovare la $\rscp(E)$ di $V$ sono problemi equivalenti.
\end{corollary}
\begin{proof2}
    Dimostriamo separatamente che la bisimulazione ricavata dalla $\rscp(E)$ è massima, e che la partizione ricavata dalla massima bisimulazione è la $\rscp(E)$.
    \begin{itemize}
        \item Sia $\mathcal{R}_M$ la massima bisimulazione su $G$. Per la Proposizione \ref{prop:bisi_max_equi} è una relazione di equivalenza. Per la Proposizione \ref{prop:bisi_induce_part} è possibile ricavare da $\mathcal{R}_M$ una partizione $\mathfrak{V}_1$ di $V$ stabile rispetto a $E$.

        Supponiamo per assurdo che $\mathfrak{V}_1 \neq \rscp(E)$ di $V$, quindi esiste una partizione $\mathfrak{V}_2$ stabile rispetto a $E$ tale che $|\mathfrak{V}_2| < |\mathfrak{V}_1|$.

        Ma per la Proposizione \ref{prop:part_induce_bisi} da
        $\mathfrak{V}_2$ è possibile ricavare una bisimulazione $\mathcal{R}_2$ su $G$. Ma quindi $|\mathcal{R}_2| < |R_M|$, che è assurdo.
        \item Sia $\mathfrak{V}_1$ la $\rscp(E)$ di $V$. Supponiamo per assurdo che la bisimulazione $\mathcal{R}$ ricavata da $\mathfrak{V}_1$ come nella Proposizione \ref{prop:part_induce_bisi} non sia massima. Allora deve esistere un'altra bisimulazione $\mathcal{R}_2$ che
        sia massima.

        Da questa si può ricavare, come mostrato nella Proposizione \ref{prop:bisi_induce_part}, una partizione $\mathfrak{V}_2$ stabile rispetto a $E$ per cui vale $|\mathfrak{V}_2| \leq |\mathfrak{V}_1|$. Ma questo è assurdo.
    \end{itemize}
    \vspace*{-0.75cm}
\end{proof2}
